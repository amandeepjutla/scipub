---
title: "scipub vignette"
author: "David Pagliaccio"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{scipub vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The scipub package contains functions for summarizing data
    for scientific publication. This includes making a "Table 1"
    to summarize demographics across groups, correlation tables
    with significance indicated by stars, and extracting formatted
    statistical summarizes from simple tests for in-text notation.
    The package also includes functions for Winsorizing data based
    on a Z-statistic cutoff.  
The `ggplot2::diamonds` dataset is used for examples.  



***
We'll start by loading scipub:

```{r, message = FALSE}
library(scipub)
library(knitr)
```


***
## `apastat`

The `apastat` function summarizes simple statistical tests to include 
in the text of an article, typically in a parenthetical. 
This is built for t-tests, correlations, anova, and regression.
Regressions can be summarized by their overall model fit or the
parameter estimates for one predictor variable.
Effect sizes are calculated where possible (default: `es=TRUE`). 
For example:



There is a significant negative correlation between diamond depth and price.
```{r}
apastat(stats::cor.test(diamonds$depth, diamonds$price), ci = TRUE)
```

Ideal cut diamonds are of significantly higher price than good cut diamonds at a small effect size.
```{r}
apastat(stats::t.test(price ~ cut, data = diamonds[diamonds$cut == "Ideal" | diamonds$cut == "Good", ]))
```

Ideal cut diamonds are of significantly higher price than good cut diamonds at a small effect size.
```{r}
apastat(stats::t.test(price ~ cut, data = diamonds[diamonds$cut == "Ideal" | diamonds$cut == "Good", ]))
```

The linear regression model predicting diamond price was highly signficant, with the predictors (cut, depth, and carat) accounting for a majority of variance in price. 
```{r}
apastat(stats::lm(data = diamonds[diamonds$cut == "Ideal" | diamonds$cut == "Good", ],  price ~ cut + depth + carat))
```

In that linear regression model, carat was a highly significant predictor of price, contrlling for cut and depth. 
```{r}
apastat(stats::lm(data = diamonds[diamonds$cut == "Ideal" | diamonds$cut == "Good", ], price ~ cut + depth + carat), var = "carat")
```





***
## `correltable`

The `correltable` function creates a summary correlation table with astericks to indicate significance. 
Variables can be renamed as part of the function call. The full matrix or upper/lower triangle can be selected for outtput. For the selected triangle, the empty row/column can be kept or deleted as needed. 
The caption provides information on the statistics included, any missing data, and the * indications. 
For example:

The lower triangle of inter-correlation among the carat, depth, and price variables are shown.
```{r results="asis"}
correltable(data = diamonds, vars = c("carat", "depth", "price"),tri="lower",html=TRUE)
```



These same variables can be relabelled in the output and, for conciseness, the columns can be indicated by corresponding number rather than variable name. 
```{r results="asis"}
correltable(data = diamonds, vars = c("carat", "depth", "price"), var_names = c("Carat", "Depth", "Price ($)"), tri = "upper", colnum = TRUE,html=TRUE)
```



The inter-correlation between two sets of variables can also be shown. 
```{r results="asis"}
correltable(data = diamonds, vars = c("carat", "depth", "price"), var_names = c("Carat", "Depth", "Price ($)"), vars2 = c("x", "y", "z"),html=TRUE)
```


The simplest call just correlates all variables in a dataset. Any non-numeric variables will be tested by t-test, chi-squared, or ANOVA as appropriate.
```{r results="asis"}
correltable(data = diamonds, html=TRUE)
```



***
## `FullTable1`
A "Table 1" can be created to summarize data, i.e. the typical first table in a paper that describes the sample characteristics.
This can display information for a single group for the declared variables .  
```{r results="asis"}
FullTable1(   data = diamonds[diamonds$cut == "Ideal" | diamonds$cut == "Good", ],   vars = c("cut", "depth", "price"),  html=TRUE)
```

Or commonly this can be shown for two groups if interest including the tests of group difference for all variables.
```{r results="asis"}
FullTable1(   data = diamonds[(diamonds$cut == "Ideal" | diamonds$cut == "Good") & (diamonds$color == "D" | diamonds$color == "J"), ],   vars = c("cut", "depth", "price"),  strata = "color", html=TRUE)
```


This can also be created for more than two groups. As with `correltable` variables can be renamed in the call.
Also the significance stars can be moved to the variable name or statistic column (or removed). The p-value column can be removed as well (same for the effect size column, but why would you want to remove that?).
```{r results="asis"}
FullTable1(   data = diamonds[(diamonds$cut == "Ideal" | diamonds$cut == "Good") & (diamonds$color == "D" | diamonds$color == "E" | diamonds$color == "J"), ],   vars = c("cut", "depth", "price"), var_names = c("Cut", "Depth", "Price ($)"),  strata = "color", stars = "name",p_col = FALSE, html=TRUE)
```

